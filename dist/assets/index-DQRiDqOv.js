(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();const g="GJE9JNEBASGDW75M",y="https://www.alphavantage.co/query";let m=null;document.addEventListener("DOMContentLoaded",()=>{document.getElementById("stockSymbol").addEventListener("keypress",t=>{t.key==="Enter"&&d()})});async function d(){const t=document.getElementById("stockSymbol").value.trim().toUpperCase();if(!t){i("Please enter a stock symbol");return}h(!0),N(),k();try{const[e,o]=await Promise.all([p(t),w(t)]);if(e.error){i(e.error);return}m=e.data,A(m),o.data&&!o.error&&Array.isArray(o.data)&&o.data.length>0?(C(o.data),document.getElementById("cashFlowSection").style.display="block"):(document.getElementById("cashFlowSection").style.display="none",console.log("Cash flow section hidden - no real financial data available")),S()}catch(e){console.error("Search error:",e),i("An unexpected error occurred. Please try again.")}finally{h(!1)}}async function p(t){try{const e=`${y}?function=GLOBAL_QUOTE&symbol=${t}&apikey=${g}`,o=await fetch(e);if(!o.ok)throw new Error(`API error: ${o.status}`);const n=await o.json();if(console.log("Alpha Vantage quote data:",n),n["Error Message"])throw new Error("Stock symbol not found. Please check the symbol and try again.");if(n.Note)throw new Error("API rate limit reached. Please try again in a minute.");if(!n["Global Quote"])throw new Error("No data available for this symbol");return{data:E(n["Global Quote"],t)}}catch(e){return console.error("Alpha Vantage API Error:",e),{error:e.message||"Failed to fetch stock data"}}}async function w(t){try{const e=`${y}?function=CASH_FLOW&symbol=${t}&apikey=${g}`;console.log("Fetching cash flow from:",e);const o=await fetch(e);if(!o.ok)return console.log("Cash flow API response not OK:",o.status),{error:"Failed to fetch cash flow data"};const n=await o.json();return console.log("Raw Alpha Vantage cash flow response:",n),n["Error Message"]?(console.log("Alpha Vantage error:",n["Error Message"]),{error:"Cash flow data not available for this symbol"}):n.Note?(console.log("Alpha Vantage rate limit:",n.Note),{error:"API rate limit reached - please wait a minute"}):n.quarterlyReports&&n.quarterlyReports.length>0?(console.log("Processing quarterly reports:",n.quarterlyReports),{data:I(n.quarterlyReports)}):(console.log("No quarterly reports found in response"),{error:"No cash flow data available"})}catch(e){return console.error("Cash Flow API Error:",e),{error:"Cash flow data not available"}}}function E(t,e){const o=Number.parseFloat(t["05. price"])||0,n=Number.parseFloat(t["09. change"])||0,r=Number.parseFloat(t["10. change percent"].replace("%",""))||0,a=Number.parseInt(t["06. volume"])||0,s=Number.parseFloat(t["03. high"])||0,u=Number.parseFloat(t["04. low"])||0,f=Number.parseFloat(t["08. previous close"])||0;return{symbol:e,name:{AAPL:"Apple Inc.",GOOGL:"Alphabet Inc.",MSFT:"Microsoft Corporation",TSLA:"Tesla, Inc.",AMZN:"Amazon.com, Inc.",META:"Meta Platforms, Inc.",NVDA:"NVIDIA Corporation",NFLX:"Netflix, Inc.",IBM:"International Business Machines Corporation",ORCL:"Oracle Corporation",CRM:"Salesforce, Inc.",ADBE:"Adobe Inc."}[e]||`${e} Corporation`,price:o,change:n,changePercent:r,volume:a,marketCap:b(o,e),peRatio:null,high52Week:s,low52Week:u,previousClose:f,dailyHigh:s,dailyLow:u}}function I(t){return console.log("Processing cash flow reports:",t),t.slice(0,4).map(e=>{console.log("Processing report:",e);const o=new Date(e.fiscalDateEnding),n=o.getFullYear(),r=o.getMonth()+1,a=Math.ceil(r/3);return console.log(`Fiscal date: ${e.fiscalDateEnding}, Year: ${n}, Quarter: Q${a}`),{period:`Q${a} ${n}`,operatingCashFlow:Number.parseInt(e.operatingCashflow)||0,investingCashFlow:Number.parseInt(e.cashflowFromInvestment)||0,financingCashFlow:Number.parseInt(e.cashflowFromFinancing)||0,freeCashFlow:(Number.parseInt(e.operatingCashflow)||0)-(Number.parseInt(e.capitalExpenditures)||0),fiscalDateEnding:e.fiscalDateEnding}})}function b(t,e){const n={AAPL:15500,GOOGL:12800,MSFT:7400,TSLA:3200,AMZN:10700,META:2700,NVDA:2500,NFLX:440,IBM:920,ORCL:2700}[e]||1e3;return t*n*1e6}function A(t){document.getElementById("stockSymbolDisplay").textContent=t.symbol,document.getElementById("stockNameDisplay").textContent=t.name;const e=document.getElementById("stockBadge"),o=document.getElementById("trendIcon"),n=document.getElementById("changePercent");t.change>=0?(e.className="badge positive",o.className="fas fa-arrow-trend-up"):(e.className="badge negative",o.className="fas fa-arrow-trend-down"),n.textContent=`${t.changePercent.toFixed(2)}%`,document.getElementById("currentPrice").textContent=c(t.price);const r=document.getElementById("priceChange");r.textContent=`${t.change>=0?"+":""}${c(t.change)}`,r.style.color=t.change>=0?"#059669":"#dc2626",document.getElementById("volume").textContent=B(t.volume),document.getElementById("marketCap").textContent=l(t.marketCap),document.getElementById("peRatio").textContent=t.peRatio?t.peRatio.toFixed(2):"N/A",document.getElementById("high52Week").textContent=c(t.dailyHigh),document.getElementById("low52Week").textContent=c(t.dailyLow)}function C(t){const e=document.getElementById("cashFlowTableBody");e.innerHTML="",t.forEach(o=>{const n=document.createElement("tr");n.innerHTML=`
            <td style="font-weight: 600;">${o.period}</td>
            <td>${l(o.operatingCashFlow)}</td>
            <td>${l(o.investingCashFlow)}</td>
            <td>${l(o.financingCashFlow)}</td>
            <td style="font-weight: 600;">${l(o.freeCashFlow)}</td>
        `,e.appendChild(n)}),document.getElementById("cashFlowSection").style.display="block"}function F(t){document.getElementById("stockSymbol").value=t,d()}function c(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function B(t){return new Intl.NumberFormat("en-US").format(t)}function l(t){const e=Math.abs(t),o=t<0?"-":"";return e>=1e12?`${o}$${(e/1e12).toFixed(2)}T`:e>=1e9?`${o}$${(e/1e9).toFixed(2)}B`:e>=1e6?`${o}$${(e/1e6).toFixed(2)}M`:e>=1e3?`${o}$${(e/1e3).toFixed(2)}K`:c(t)}function h(t){const e=document.getElementById("searchBtn"),o=document.getElementById("searchBtnText"),n=document.getElementById("searchSpinner"),r=document.getElementById("loadingState");t?(e.disabled=!0,o.style.display="none",n.style.display="inline-block",r.style.display="grid"):(e.disabled=!1,o.style.display="inline-block",n.style.display="none",r.style.display="none")}function i(t){const e=document.getElementById("errorAlert"),o=document.getElementById("errorMessage");o.textContent=t,e.style.display="flex"}function N(){document.getElementById("errorAlert").style.display="none"}function S(){document.getElementById("stockDataSection").style.display="block"}function k(){document.getElementById("stockDataSection").style.display="none",document.getElementById("cashFlowSection").style.display="none"}window.searchStock=d;window.searchPopularStock=F;
